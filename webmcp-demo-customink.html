<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Custom Short Sleeve T-Shirts | CustomInk</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@300;400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet" />
  <style>
    /* === TOKENS === */
    :root {
      --orange:        #fa3c00;
      --orange-hover:  #e03600;
      --blue:          #1e39d2;
      --page-bg:       #fafafa;
      --surface:       #ffffff;
      --chip-bg:       #f5f5f5;
      --promo-bg:      #242424;
      --eco-bg:        #b6edaf;
      --text-primary:  rgba(0,0,0,0.86);
      --text-secondary:rgba(0,0,0,0.57);
      --text-muted:    rgba(0,0,0,0.38);
      --border:        rgba(0,0,0,0.11);
      --border-light:  rgba(0,0,0,0.06);
      /* debugger / log shared */
      --accent-amber:  #fa3c00;
      --accent-blue:   #1e39d2;
      --accent-green:  #198038;
      --accent-red:    #da1e28;
      --bg-base:       #fafafa;
      --bg-surface:    #ffffff;
      --bg-raised:     #f5f5f5;
      --font-ui:  "Source Sans 3", system-ui, sans-serif;
      --font-mono:"IBM Plex Mono", monospace;
      --radius-sm: 4px;
      --radius-md: 8px;
    }

    /* === RESET === */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      font-family: var(--font-ui);
      font-size: 16px;
      color: var(--text-primary);
      background: var(--page-bg);
      -webkit-font-smoothing: antialiased;
    }
    a { color: var(--blue); text-decoration: none; }
    a:hover { text-decoration: underline; }
    [hidden] { display: none !important; }

    /* === POLYFILL BANNER === */
    #polyfill-warning {
      background: #fff4f0;
      border-bottom: 1px solid rgba(250,60,0,0.3);
      color: #e03600;
      font-family: var(--font-mono);
      font-size: 12px;
      padding: 7px 16px;
      text-align: center;
    }

    /* === PROMO BAR === */
    .promo-bar {
      background: var(--promo-bg);
      color: #fff;
      font-size: 13px;
      font-weight: 500;
      text-align: center;
      padding: 0 16px;
      height: 33px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      flex-shrink: 0;
    }
    .promo-bar a { color: #fff; font-weight: 700; text-decoration: underline; }

    /* === HEADER === */
    .site-header { background: var(--surface); position: sticky; top: 0; z-index: 200; box-shadow: 0 1px 0 var(--border); }

    /* Row 1: utility */
    .header-utility {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 0 24px;
      height: 57px;
      border-bottom: 1px solid var(--border-light);
    }
    .site-logo {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-shrink: 0;
      text-decoration: none;
    }
    .logo-mark {
      width: 36px;
      height: 36px;
      flex-shrink: 0;
    }
    .logo-wordmark {
      font-size: 18px;
      font-weight: 700;
      color: var(--orange);
      letter-spacing: -0.02em;
      line-height: 1;
    }
    .header-search {
      flex: 1;
      max-width: 468px;
      position: relative;
    }
    .header-search input {
      width: 100%;
      height: 40px;
      border: none;
      border-radius: 4px;
      background: rgba(0,0,0,0.04);
      padding: 0 16px 0 40px;
      font-family: var(--font-ui);
      font-size: 15px;
      color: var(--text-primary);
      outline: none;
    }
    .header-search input:focus { box-shadow: 0 0 0 2px rgba(30,57,210,0.3); }
    .header-search-icon {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-muted);
    }
    .header-contact {
      display: flex;
      align-items: center;
      gap: 20px;
      margin-left: auto;
      font-size: 12px;
    }
    .header-contact-item { display: flex; align-items: center; gap: 5px; color: var(--text-secondary); }
    .header-contact-item strong { color: var(--blue); font-weight: 500; cursor: pointer; }
    .header-contact-item strong.orange { color: var(--orange); }
    /* Agent + WebMCP badges in utility row */
    .header-badges { display: flex; align-items: center; gap: 8px; margin-left: 12px; }
    .badge-webmcp {
      font-size: 11px;
      font-weight: 600;
      font-family: var(--font-mono);
      padding: 3px 9px;
      border-radius: 12px;
      background: rgba(30,57,210,0.08);
      border: 1px solid rgba(30,57,210,0.25);
      color: var(--blue);
      letter-spacing: 0.03em;
    }
    #agent-status {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 3px 10px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 500;
      font-family: var(--font-mono);
      background: rgba(0,0,0,0.04);
      border: 1px solid var(--border);
      color: var(--text-muted);
      transition: all 0.3s;
    }
    #agent-status.active {
      background: rgba(25,128,56,0.08);
      border-color: rgba(25,128,56,0.3);
      color: var(--accent-green);
    }
    .status-dot {
      width: 7px; height: 7px;
      border-radius: 50%;
      background: rgba(0,0,0,0.2);
      flex-shrink: 0;
      transition: background 0.3s;
    }
    #agent-status.active .status-dot {
      background: var(--accent-green);
      animation: pulse-green 1.6s ease-in-out infinite;
    }
    @keyframes pulse-green {
      0%,100% { box-shadow: 0 0 0 0 rgba(25,128,56,0.5); }
      50%      { box-shadow: 0 0 0 5px rgba(25,128,56,0); }
    }

    /* Row 2: main nav */
    .header-nav {
      display: flex;
      align-items: center;
      padding: 0 24px;
      height: 48px;
    }
    .nav-links {
      display: flex;
      align-items: stretch;
      gap: 0;
      flex: 1;
    }
    .nav-link {
      padding: 0 14px;
      font-size: 15px;
      font-weight: 400;
      color: var(--text-primary);
      text-decoration: none;
      display: flex;
      align-items: center;
      border-bottom: 2px solid transparent;
      transition: color 0.15s, border-color 0.15s;
      white-space: nowrap;
      cursor: pointer;
    }
    .nav-link:hover { color: var(--orange); border-bottom-color: var(--orange); text-decoration: none; }
    .nav-link.active { color: var(--orange); border-bottom-color: var(--orange); font-weight: 600; }
    .nav-actions {
      display: flex;
      align-items: center;
      gap: 4px;
      margin-left: auto;
    }
    .nav-icon-btn {
      width: 40px; height: 40px;
      display: flex; align-items: center; justify-content: center;
      border: none; background: transparent; cursor: pointer;
      border-radius: 4px; color: var(--text-secondary);
      font-size: 18px;
      position: relative;
      transition: background 0.15s;
    }
    .nav-icon-btn:hover { background: rgba(0,0,0,0.05); }
    .nav-icon-label { font-size: 12px; color: var(--text-secondary); }
    .cart-count-badge {
      position: absolute;
      top: 4px; right: 4px;
      min-width: 16px; height: 16px;
      background: var(--orange);
      color: #fff;
      font-size: 10px;
      font-weight: 700;
      font-family: var(--font-mono);
      border-radius: 8px;
      display: flex; align-items: center; justify-content: center;
      padding: 0 3px;
      line-height: 1;
    }
    .cart-count-badge[data-count="0"] { display: none; }
    /* Learning Mode toggle in nav */
    .learning-mode-wrap {
      display: flex; align-items: center; gap: 7px;
      padding: 0 10px;
      border-left: 1px solid var(--border-light);
      margin-left: 4px;
      cursor: pointer;
      user-select: none;
    }
    .learning-mode-wrap .lm-label {
      font-size: 11.5px;
      font-weight: 600;
      color: var(--text-secondary);
      letter-spacing: 0.03em;
      white-space: nowrap;
    }
    .lm-input { display: none; }
    .lm-track {
      width: 34px; height: 19px;
      background: rgba(0,0,0,0.15);
      border-radius: 10px;
      border: 1px solid rgba(0,0,0,0.15);
      position: relative;
      flex-shrink: 0;
      transition: background 0.2s, border-color 0.2s;
    }
    .lm-track::after {
      content: "";
      position: absolute;
      top: 2px; left: 2px;
      width: 13px; height: 13px;
      background: #fff;
      border-radius: 50%;
      transition: transform 0.2s;
      box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    }
    .lm-input:checked + .lm-track { background: var(--orange); border-color: var(--orange-hover); }
    .lm-input:checked + .lm-track::after { transform: translateX(15px); }
    .lm-input:checked ~ .lm-label { color: var(--orange); }

    /* Tool log toggle btn */
    #tool-log-toggle {
      display: flex; align-items: center; gap: 5px;
      padding: 5px 10px;
      font-size: 12px; font-weight: 600;
      font-family: var(--font-ui);
      background: transparent;
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      cursor: pointer;
      color: var(--text-secondary);
      transition: background 0.15s, border-color 0.15s, color 0.15s;
      margin-right: 6px;
    }
    #tool-log-toggle:hover { background: var(--chip-bg); border-color: rgba(0,0,0,0.2); color: var(--text-primary); }
    #tool-log-toggle.active { background: rgba(30,57,210,0.07); border-color: rgba(30,57,210,0.3); color: var(--blue); }

    /* === BREADCRUMB === */
    .breadcrumb-bar {
      max-width: 1240px;
      margin: 0 auto;
      padding: 12px 24px 0;
    }
    .breadcrumb {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 13px;
      color: var(--text-secondary);
    }
    .breadcrumb a { color: var(--blue); }
    .breadcrumb-sep { color: var(--text-muted); }
    .page-h1 {
      font-size: 28px;
      font-weight: 700;
      color: var(--text-primary);
      margin: 8px 0 4px;
      line-height: 1.2;
    }

    /* === PAGE LAYOUT === */
    .page-body {
      max-width: 1240px;
      margin: 0 auto;
      padding: 16px 24px 40px;
      display: grid;
      grid-template-columns: 238px 1fr;
      gap: 24px;
      align-items: start;
    }

    /* === SIDEBAR === */
    .filter-sidebar { position: sticky; top: 106px; }
    .sidebar-section { margin-bottom: 20px; }
    .sidebar-section-header {
      display: flex; align-items: center; justify-content: space-between;
      font-size: 15px; font-weight: 400;
      color: var(--text-primary);
      padding: 8px 0;
      border-bottom: 1px solid var(--border-light);
      cursor: pointer;
      user-select: none;
    }
    .sidebar-section-toggle { color: var(--text-muted); font-size: 14px; font-weight: 700; }
    .sidebar-cat-list { list-style: none; margin-top: 6px; }
    .sidebar-cat-list li a {
      display: block;
      padding: 5px 0 5px 8px;
      font-size: 14px;
      color: var(--text-primary);
      text-decoration: none;
      border-radius: 3px;
    }
    .sidebar-cat-list li a:hover { background: rgba(0,0,0,0.04); text-decoration: none; }
    .sidebar-cat-list li a.active { font-weight: 700; color: var(--text-primary); }
    .sidebar-show-more { font-size: 13px; color: var(--blue); display: flex; align-items: center; gap: 4px; margin-top: 4px; cursor: pointer; padding: 4px 8px; }
    .sidebar-show-more:hover { text-decoration: underline; }

    /* No minimum toggle */
    .no-min-row {
      display: flex; align-items: center; justify-content: space-between;
      padding: 10px 0;
      font-size: 15px;
      border-bottom: 1px solid var(--border-light);
      margin-bottom: 2px;
    }
    .ios-toggle { position: relative; width: 42px; height: 24px; flex-shrink: 0; }
    .ios-toggle input { display: none; }
    .ios-track {
      position: absolute; inset: 0;
      background: rgba(0,0,0,0.15);
      border-radius: 12px;
      cursor: pointer;
      transition: background 0.2s;
    }
    .ios-track::after {
      content: "";
      position: absolute;
      top: 2px; left: 2px;
      width: 20px; height: 20px;
      background: #fff;
      border-radius: 50%;
      box-shadow: 0 1px 3px rgba(0,0,0,0.3);
      transition: transform 0.2s;
    }
    .ios-toggle input:checked + .ios-track { background: var(--blue); }
    .ios-toggle input:checked + .ios-track::after { transform: translateX(18px); }

    /* Color swatches */
    .swatch-grid { display: flex; flex-wrap: wrap; gap: 6px; padding: 8px 0; }
    .swatch {
      width: 20px; height: 20px;
      border-radius: 50%;
      border: 1.5px solid rgba(0,0,0,0.12);
      cursor: pointer;
      transition: transform 0.1s, box-shadow 0.1s;
    }
    .swatch:hover { transform: scale(1.15); box-shadow: 0 0 0 2px rgba(0,0,0,0.15); }
    .swatch.active { box-shadow: 0 0 0 2px var(--blue); }

    /* Checkbox filters */
    .filter-option {
      display: flex; align-items: center; gap: 9px;
      padding: 5px 0;
      font-size: 14px;
      cursor: pointer;
      user-select: none;
    }
    .filter-option input[type="checkbox"] { width: 15px; height: 15px; accent-color: var(--blue); flex-shrink: 0; cursor: pointer; }
    .filter-option .count { color: var(--text-muted); font-size: 13px; margin-left: auto; }

    /* Rush chip */
    .rush-chip { display: inline-flex; align-items: center; gap: 4px; font-size: 12px; font-weight: 600; color: var(--text-primary); background: var(--chip-bg); padding: 3px 8px; border-radius: 4px; margin-left: 6px; }

    /* === PRODUCT MAIN === */
    .product-toolbar {
      display: flex; align-items: center; justify-content: space-between;
      padding: 0 0 14px;
      border-bottom: 1px solid var(--border-light);
      margin-bottom: 16px;
    }
    .toolbar-left { display: flex; align-items: center; gap: 12px; }
    .toolbar-filters-btn {
      font-size: 14px; font-weight: 500;
      padding: 7px 14px;
      border: 1px solid var(--border);
      border-radius: 4px;
      background: var(--surface);
      cursor: pointer;
      color: var(--text-primary);
      display: flex; align-items: center; gap: 6px;
    }
    .result-count { font-size: 14px; font-weight: 500; color: var(--text-secondary); }
    .sort-control { font-size: 14px; display: flex; align-items: center; gap: 4px; cursor: pointer; }
    .sort-label { color: var(--text-secondary); }
    .sort-value { color: var(--blue); font-weight: 500; display: flex; align-items: center; gap: 2px; }

    /* === PRODUCT GRID === */
    #product-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
    }

    /* Product Card */
    .ci-card {
      background: transparent;
      border-radius: var(--radius-md);
      overflow: visible;
      cursor: pointer;
      transition: transform 0.15s;
      position: relative;
    }
    .ci-card:hover { transform: translateY(-2px); }
    .ci-card:hover .ci-card-img { box-shadow: 0 6px 20px rgba(0,0,0,0.1); }

    .ci-card-img-wrap {
      position: relative;
      border-radius: var(--radius-md);
      overflow: hidden;
      background: var(--surface);
      margin-bottom: 8px;
    }
    .ci-card-img {
      width: 100%;
      aspect-ratio: 3/4;
      background: var(--surface);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      gap: 8px;
      transition: box-shadow 0.15s;
    }
    .ci-card-emoji { font-size: 88px; line-height: 1; }
    .ci-card-watermark {
      font-size: 12px;
      letter-spacing: 0.12em;
      color: rgba(0,0,0,0.13);
      font-weight: 600;
      text-transform: uppercase;
    }
    /* Badge overlay */
    .ci-badge {
      position: absolute;
      top: 10px; left: 10px;
      background: var(--orange);
      color: #fff;
      font-size: 11px;
      font-weight: 700;
      padding: 3px 9px;
      border-radius: 3px;
      letter-spacing: 0.02em;
      line-height: 1.4;
      z-index: 1;
    }
    /* Eco badge */
    .ci-eco {
      position: absolute;
      bottom: 10px; right: 10px;
      background: var(--eco-bg);
      color: rgba(0,0,0,0.75);
      font-size: 11px;
      font-weight: 700;
      padding: 3px 8px;
      border-radius: 3px;
      display: flex; align-items: center; gap: 4px;
    }
    /* Wishlist heart */
    .ci-wishlist {
      position: absolute;
      top: 8px; right: 8px;
      width: 30px; height: 30px;
      display: flex; align-items: center; justify-content: center;
      background: rgba(255,255,255,0.85);
      border-radius: 50%;
      font-size: 15px;
      cursor: pointer;
      opacity: 0;
      transition: opacity 0.15s;
      z-index: 2;
    }
    .ci-card:hover .ci-wishlist { opacity: 1; }

    /* Card body */
    .ci-card-body { padding: 0 2px; }
    .ci-swatches { display: flex; align-items: center; gap: 3px; margin-bottom: 7px; flex-wrap: wrap; }
    .ci-swatch {
      width: 16px; height: 16px;
      border-radius: 50%;
      border: 1px solid rgba(0,0,0,0.12);
      flex-shrink: 0;
      cursor: pointer;
    }
    .ci-swatch-more { font-size: 11px; color: var(--text-muted); margin-left: 2px; }
    .ci-card-name {
      font-size: 14px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 4px;
      line-height: 1.3;
    }
    .ci-card-name a { color: inherit; }
    .ci-card-name a:hover { color: var(--blue); text-decoration: none; }
    .ci-rating { display: flex; align-items: center; gap: 5px; margin-bottom: 5px; }
    .ci-stars { color: #f5a623; font-size: 13px; letter-spacing: -1px; }
    .ci-rating-score { font-size: 13px; color: var(--text-primary); }
    .ci-rating-count { font-size: 12px; color: var(--text-muted); }
    .ci-price { font-size: 13px; font-weight: 500; color: var(--text-primary); margin-bottom: 2px; }
    .ci-price-link { font-size: 12px; color: var(--blue); }
    .ci-rush-chip { display: inline-flex; align-items: center; gap: 4px; font-size: 11.5px; font-weight: 600; color: var(--text-primary); background: var(--chip-bg); padding: 3px 8px; border-radius: 4px; margin-top: 6px; }
    .ci-no-min { font-size: 13px; color: var(--text-secondary); margin-top: 4px; }

    /* === FOOTER === */
    .site-footer { background: var(--surface); border-top: 1px solid var(--border-light); margin-top: 40px; }
    .footer-main {
      max-width: 1240px;
      margin: 0 auto;
      padding: 40px 24px 32px;
      display: grid;
      grid-template-columns: 220px 1fr 1fr;
      gap: 40px;
    }
    .footer-logo { display: flex; flex-direction: column; gap: 16px; }
    .footer-social { display: flex; gap: 10px; flex-wrap: wrap; }
    .footer-social-link {
      width: 32px; height: 32px;
      border-radius: 50%;
      background: var(--chip-bg);
      display: flex; align-items: center; justify-content: center;
      font-size: 14px;
      text-decoration: none;
      transition: background 0.15s;
    }
    .footer-social-link:hover { background: rgba(250,60,0,0.1); text-decoration: none; }
    .footer-col h6 { font-size: 12px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.08em; color: var(--text-primary); margin-bottom: 10px; }
    .footer-links { list-style: none; display: flex; flex-direction: column; gap: 7px; }
    .footer-links li a { font-size: 15px; color: var(--text-secondary); }
    .footer-links li a:hover { color: var(--text-primary); }
    .footer-coda {
      background: var(--chip-bg);
      color: #242424;
      font-size: 12px;
      text-align: center;
      padding: 20px 24px;
      line-height: 1.8;
    }
    .footer-coda a { color: #242424; }

    /* === CART DRAWER === */
    .cart-backdrop {
      display: none;
      position: fixed; inset: 0;
      background: rgba(0,0,0,0.45);
      z-index: 400;
    }
    .cart-backdrop.open { display: block; }
    .cart-drawer {
      position: fixed;
      top: 0; right: 0; bottom: 0;
      width: 420px;
      background: var(--surface);
      z-index: 401;
      transform: translateX(100%);
      transition: transform 0.28s cubic-bezier(0.4,0,0.2,1);
      display: flex;
      flex-direction: column;
      box-shadow: -4px 0 24px rgba(0,0,0,0.12);
    }
    .cart-drawer.open { transform: translateX(0); }
    .cart-drawer-header {
      display: flex; align-items: center; justify-content: space-between;
      padding: 16px 20px;
      border-bottom: 1px solid var(--border-light);
      flex-shrink: 0;
    }
    .cart-drawer-title { font-size: 18px; font-weight: 700; display: flex; align-items: center; gap: 10px; }
    .cart-drawer-badge {
      background: var(--orange);
      color: #fff;
      font-size: 12px;
      font-weight: 700;
      font-family: var(--font-mono);
      padding: 1px 8px;
      border-radius: 10px;
    }
    .cart-drawer-close {
      width: 34px; height: 34px;
      display: flex; align-items: center; justify-content: center;
      border: none; background: transparent; cursor: pointer;
      font-size: 20px; color: var(--text-muted);
      border-radius: 4px;
      transition: background 0.15s;
    }
    .cart-drawer-close:hover { background: var(--chip-bg); }
    .cart-drawer-body { flex: 1; overflow-y: auto; padding: 8px 0; }
    .cart-item-ci {
      display: flex; align-items: flex-start; gap: 12px;
      padding: 14px 20px;
      border-bottom: 1px solid var(--border-light);
    }
    .cart-item-emoji { font-size: 36px; flex-shrink: 0; line-height: 1; }
    .cart-item-info { flex: 1; min-width: 0; }
    .cart-item-name-ci { font-size: 14px; font-weight: 600; margin-bottom: 3px; }
    .cart-item-meta-ci { font-size: 12px; color: var(--text-secondary); font-family: var(--font-mono); line-height: 1.6; }
    .cart-item-price-ci { font-size: 14px; font-weight: 700; color: var(--orange); font-family: var(--font-mono); white-space: nowrap; }
    .cart-empty-ci { padding: 48px 20px; text-align: center; color: var(--text-secondary); }
    .cart-empty-icon { font-size: 40px; margin-bottom: 12px; opacity: 0.4; }
    .cart-drawer-footer {
      border-top: 1px solid var(--border-light);
      padding: 20px;
      flex-shrink: 0;
    }
    .cart-total-ci { display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; }
    .cart-total-label-ci { font-size: 15px; font-weight: 600; }
    .cart-total-amount-ci { font-size: 22px; font-weight: 700; color: var(--orange); font-family: var(--font-mono); }
    .btn-checkout {
      display: block; width: 100%;
      padding: 14px;
      background: var(--blue);
      color: #fff;
      font-size: 16px;
      font-weight: 700;
      font-family: var(--font-ui);
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.15s;
      text-align: center;
    }
    .btn-checkout:hover { background: #172db8; }
    .cart-hint-ci { font-size: 12px; color: var(--text-muted); text-align: center; margin-top: 10px; }

    /* === TOOL LOG PANEL (floating, bottom-right) === */
    .tool-log-panel {
      position: fixed;
      bottom: 16px; right: 16px;
      width: 380px;
      max-height: 420px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      box-shadow: 0 8px 32px rgba(0,0,0,0.12);
      z-index: 300;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      opacity: 0;
      pointer-events: none;
      transform: translateY(8px);
      transition: opacity 0.2s, transform 0.2s;
    }
    .tool-log-panel.open {
      opacity: 1;
      pointer-events: auto;
      transform: translateY(0);
    }
    /* when step debugger is open, shift the tool log up */
    body.sdb-panel-open .tool-log-panel { bottom: 356px; }
    .tlp-header {
      display: flex; align-items: center; justify-content: space-between;
      padding: 10px 14px;
      border-bottom: 1px solid var(--border-light);
      flex-shrink: 0;
      background: var(--chip-bg);
    }
    .tlp-title {
      display: flex; align-items: center; gap: 8px;
      font-size: 12px; font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.07em;
      color: var(--text-secondary);
    }
    .live-dot {
      width: 7px; height: 7px; border-radius: 50%;
      background: var(--accent-green);
      animation: pulse-green 1.6s ease-in-out infinite;
      flex-shrink: 0;
    }
    .tlp-close {
      width: 24px; height: 24px;
      border: none; background: transparent; cursor: pointer;
      font-size: 16px; color: var(--text-muted);
      display: flex; align-items: center; justify-content: center;
      border-radius: 3px;
    }
    .tlp-close:hover { background: rgba(0,0,0,0.06); }
    #tool-log {
      flex: 1;
      overflow-y: auto;
      font-family: var(--font-mono);
      font-size: 11.5px;
      line-height: 1.5;
      scrollbar-width: thin;
      scrollbar-color: var(--border) transparent;
    }
    #tool-log::-webkit-scrollbar { width: 4px; }
    #tool-log::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }

    /* Log entry styles */
    .log-entry { border-bottom: 1px solid var(--border-light); padding: 7px 14px; }
    .log-entry:hover { background: var(--chip-bg); }
    .log-header { display: flex; align-items: center; gap: 7px; flex-wrap: wrap; margin-bottom: 3px; }
    .log-time { color: var(--text-muted); font-size: 10px; flex-shrink: 0; }
    .log-name { font-weight: 600; font-size: 11.5px; }
    .log-duration { font-size: 10px; color: var(--text-secondary); margin-left: auto; background: var(--chip-bg); padding: 1px 5px; border-radius: 3px; border: 1px solid var(--border-light); }
    .log-msg { color: var(--text-secondary); font-size: 11px; margin-top: 2px; display: block; }
    .log-params, .log-result { margin-top: 3px; padding: 4px 7px; border-radius: 3px; font-size: 10px; line-height: 1.6; word-break: break-all; white-space: pre-wrap; }
    .log-params { background: rgba(30,57,210,0.04); border-left: 2px solid rgba(30,57,210,0.25); color: var(--text-secondary); }
    .log-result { background: rgba(25,128,56,0.04); border-left: 2px solid rgba(25,128,56,0.25); color: var(--text-secondary); }
    .log-system .log-name { color: var(--blue); }
    .log-system { border-left: 2px solid rgba(30,57,210,0.3); }
    .log-success .log-name { color: var(--accent-green); }
    .log-error .log-name { color: var(--accent-red); }
    .log-error { border-left: 2px solid rgba(218,30,40,0.3); }
    .log-call .log-name { color: var(--orange); }
    .log-call { border-left: 2px solid rgba(250,60,0,0.35); }

    /* === STEP DEBUGGER PANEL === */
    body.sdb-panel-open { padding-bottom: 340px; }
    body.sdb-panel-open #sdb-paused-banner { bottom: 340px; }

    #sdb-paused-banner {
      display: none;
      position: fixed;
      bottom: 340px; left: 0; right: 0;
      z-index: 998;
      background: rgba(250,60,0,0.07);
      border-bottom: 1px solid rgba(250,60,0,0.2);
      padding: 4px 14px;
      font-size: 11px;
      font-family: var(--font-mono);
      color: var(--orange);
      text-align: center;
      letter-spacing: 0.03em;
    }
    #sdb-paused-banner.visible { display: block; }

    #step-debugger {
      position: fixed;
      bottom: 0; left: 0; right: 0;
      z-index: 999;
      height: 0;
      overflow: hidden;
      transition: height 0.25s cubic-bezier(0.4,0,0.2,1);
      background: var(--surface);
      border-top: 2px solid var(--border);
      box-shadow: 0 -4px 24px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      font-family: var(--font-ui);
    }
    #step-debugger.open { height: 340px; border-top-color: var(--orange); }
    #step-debugger.complete { border-top-color: var(--accent-green); }

    .sdb-topbar {
      display: flex; align-items: center; gap: 10px;
      padding: 8px 14px;
      background: var(--chip-bg);
      border-bottom: 1px solid var(--border-light);
      flex-shrink: 0; min-height: 40px;
    }
    .sdb-breakpoint-icon {
      width: 10px; height: 10px; border-radius: 50%;
      background: var(--orange); flex-shrink: 0;
      box-shadow: 0 0 0 2px rgba(250,60,0,0.25);
      animation: sdb-pulse 1.4s ease-in-out infinite;
    }
    @keyframes sdb-pulse {
      0%,100% { box-shadow: 0 0 0 2px rgba(250,60,0,0.25); }
      50%      { box-shadow: 0 0 0 5px rgba(250,60,0,0.0); }
    }
    #step-debugger.complete .sdb-breakpoint-icon { background: var(--accent-green); box-shadow: 0 0 0 2px rgba(25,128,56,0.2); animation: none; }
    .sdb-tool-name { font-family: var(--font-mono); font-size: 13px; font-weight: 600; color: var(--orange); flex-shrink: 0; }
    #step-debugger.complete .sdb-tool-name { color: var(--accent-green); }
    .sdb-status-badge { font-size: 10px; font-family: var(--font-mono); font-weight: 600; padding: 2px 8px; border-radius: 3px; letter-spacing: 0.05em; text-transform: uppercase; }
    .sdb-status-badge.paused { background: rgba(250,60,0,0.1); border: 1px solid rgba(250,60,0,0.35); color: var(--orange); }
    .sdb-status-badge.complete { background: rgba(25,128,56,0.08); border: 1px solid rgba(25,128,56,0.3); color: var(--accent-green); }
    .sdb-topbar-right { margin-left: auto; display: flex; align-items: center; gap: 8px; }
    .sdb-title-prefix { font-size: 10.5px; color: var(--text-muted); font-family: var(--font-mono); letter-spacing: 0.03em; }

    .btn-sdb-step {
      display: inline-flex; align-items: center; gap: 5px;
      padding: 5px 14px;
      font-family: var(--font-ui); font-size: 12px; font-weight: 600;
      background: var(--accent-green); color: #fff;
      border: none; border-radius: var(--radius-sm);
      cursor: pointer; transition: background 0.15s, transform 0.1s;
      letter-spacing: 0.02em;
    }
    .btn-sdb-step:hover { background: #156b30; transform: translateY(-1px); }
    .btn-sdb-step:active { transform: translateY(0); }
    .btn-sdb-step:disabled { background: var(--chip-bg); color: var(--text-muted); cursor: default; transform: none; border: 1px solid var(--border); }

    .btn-sdb-runall {
      display: inline-flex; align-items: center; gap: 5px;
      padding: 5px 12px;
      font-family: var(--font-ui); font-size: 11px; font-weight: 500;
      background: transparent; color: var(--text-secondary);
      border: 1px solid var(--border); border-radius: var(--radius-sm);
      cursor: pointer; transition: color 0.15s, border-color 0.15s, background 0.15s;
    }
    .btn-sdb-runall:hover { color: var(--blue); border-color: rgba(30,57,210,0.35); background: rgba(30,57,210,0.04); }

    .btn-sdb-close {
      width: 24px; height: 24px;
      display: inline-flex; align-items: center; justify-content: center;
      font-size: 14px; color: var(--text-muted);
      background: transparent; border: none; border-radius: var(--radius-sm);
      cursor: pointer; transition: color 0.15s, background 0.15s; flex-shrink: 0;
    }
    .btn-sdb-close:hover { color: var(--text-primary); background: var(--chip-bg); }

    .sdb-tab-bar {
      display: flex; align-items: stretch;
      background: var(--chip-bg);
      border-bottom: 1px solid var(--border-light);
      flex-shrink: 0; padding: 0 14px; gap: 0;
    }
    .sdb-tab {
      padding: 7px 14px; font-size: 11.5px; font-weight: 500;
      color: var(--text-secondary); cursor: pointer; border: none;
      background: transparent; border-bottom: 2px solid transparent;
      transition: color 0.15s, border-color 0.15s;
      font-family: var(--font-ui); letter-spacing: 0.01em; white-space: nowrap;
    }
    .sdb-tab:hover { color: var(--text-primary); }
    .sdb-tab.active { color: var(--orange); border-bottom-color: var(--orange); font-weight: 600; }
    .sdb-tab-dot { display: inline-block; width: 6px; height: 6px; border-radius: 50%; background: var(--accent-green); margin-left: 5px; vertical-align: middle; opacity: 0; transition: opacity 0.2s; }
    .sdb-tab.has-data .sdb-tab-dot { opacity: 1; }

    .sdb-content { flex: 1; overflow: hidden; position: relative; }
    .sdb-pane { display: none; height: 100%; overflow-y: auto; padding: 12px 14px; scrollbar-width: thin; scrollbar-color: var(--border) transparent; }
    .sdb-pane::-webkit-scrollbar { width: 4px; }
    .sdb-pane::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }
    .sdb-pane.active { display: block; }

    .sdb-json {
      font-family: var(--font-mono); font-size: 11.5px; line-height: 1.6;
      white-space: pre-wrap; word-break: break-all;
      background: var(--chip-bg); border: 1px solid var(--border);
      border-radius: var(--radius-sm); padding: 10px 12px;
      color: var(--text-secondary); margin: 0;
    }
    .sdb-json-label { font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.08em; color: var(--text-muted); margin-bottom: 6px; display: block; font-family: var(--font-mono); }
    .sdb-pane-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    .sdb-pane-col { display: flex; flex-direction: column; gap: 4px; }

    .sdb-explainer-tool { font-family: var(--font-mono); font-size: 12px; font-weight: 600; color: var(--orange); margin-bottom: 4px; }
    .sdb-explainer-text { font-size: 13px; line-height: 1.65; color: var(--text-primary); max-width: 820px; }
    .sdb-explainer-text p { margin: 0 0 10px; }
    .sdb-explainer-text p:last-child { margin: 0; }
    .sdb-explainer-params { margin-top: 12px; display: flex; flex-direction: column; gap: 4px; }
    .sdb-param-row { display: flex; gap: 8px; align-items: baseline; font-size: 12px; padding: 4px 8px; border-radius: var(--radius-sm); background: var(--chip-bg); border: 1px solid var(--border); }
    .sdb-param-name { font-family: var(--font-mono); font-weight: 600; color: var(--blue); font-size: 11.5px; flex-shrink: 0; }
    .sdb-param-value { font-family: var(--font-mono); color: var(--text-secondary); font-size: 11px; word-break: break-all; }

    .sdb-response-header { display: flex; align-items: center; gap: 8px; margin-bottom: 8px; }
    .sdb-response-title { font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.07em; color: var(--text-muted); font-family: var(--font-mono); }
    .sdb-what-changed { margin-top: 12px; padding: 10px 12px; background: rgba(25,128,56,0.04); border: 1px solid rgba(25,128,56,0.2); border-radius: var(--radius-sm); }
    .sdb-what-changed-title { font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.08em; color: var(--accent-green); margin-bottom: 6px; font-family: var(--font-mono); }
    .sdb-what-changed-list { list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 3px; }
    .sdb-what-changed-list li { font-size: 12px; color: var(--text-secondary); font-family: var(--font-mono); display: flex; gap: 6px; }
    .sdb-what-changed-list li::before { content: "â†’"; color: var(--accent-green); flex-shrink: 0; }
  </style>
</head>
<body>

<!-- Polyfill Warning -->
<div id="polyfill-warning" hidden>
  &nbsp;âš &nbsp; <strong>navigator.modelContext not found.</strong> Using @mcp-b/global polyfill â€” tools may behave differently than native WebMCP.
</div>

<!-- Promo Bar -->
<div class="promo-bar">
  15% off Gildan Sweats â€” Prices as Marked.*&nbsp;
  <a href="#">Shop Sale</a>
</div>

<!-- Header -->
<header class="site-header">

  <!-- Row 1: Utility -->
  <div class="header-utility">
    <a href="#" class="site-logo">
      <img class="ci-logo-img" alt="CustomInk" style="height:40px;width:auto;" />
    </a>

    <div class="header-search">
      <svg class="header-search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
      <input type="search" placeholder="Search for t-shirts, hoodies, koozies, and more" aria-label="Search products" />
    </div>

    <div class="header-contact">
      <div class="header-contact-item">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07A19.5 19.5 0 0 1 4.69 13.5 19.79 19.79 0 0 1 1.6 4.87 2 2 0 0 1 3.59 2.68h3a2 2 0 0 1 2 1.72c.127.96.361 1.903.7 2.81a2 2 0 0 1-.45 2.11L7.91 10a16 16 0 0 0 6 6l.92-.92a2 2 0 0 1 2.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0 1 21.73 17l.19-.08z"/></svg>
        <span>Talk to a Real Person &nbsp;<strong><a href="tel:8552712660">855-271-2660</a></strong></span>
      </div>
      <div class="header-contact-item">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
        <span>Chat with a Real Person &nbsp;<strong class="orange">Chat Now</strong></span>
      </div>
    </div>

    <div class="header-badges">
      <span class="badge-webmcp" id="webmcp-badge">WebMCP</span>
      <div id="agent-status" role="status" aria-live="polite">
        <span class="status-dot" aria-hidden="true"></span>
        <span class="status-label">Idle</span>
      </div>
    </div>
  </div>

  <!-- Row 2: Nav -->
  <nav class="header-nav" aria-label="Main navigation">
    <div class="nav-links">
      <a href="#" class="nav-link active">Custom T-shirts</a>
      <a href="#" class="nav-link">Custom Apparel</a>
      <a href="#" class="nav-link">Promotional Products</a>
      <a href="#" class="nav-link">Design Lab</a>
      <a href="#" class="nav-link">Groups &amp; Events</a>
    </div>
    <div class="nav-actions">
      <!-- Tool log toggle -->
      <button id="tool-log-toggle" aria-label="Toggle tool activity log" title="WebMCP Tool Activity Log">
        <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
        Tools
      </button>
      <!-- Learning mode toggle -->
      <label class="learning-mode-wrap" title="Enable step-by-step tool call debugging">
        <input type="checkbox" id="learning-mode-checkbox" class="lm-input" autocomplete="off" />
        <span class="lm-track"></span>
        <span class="lm-label">Learning Mode</span>
      </label>
      <!-- Wishlist -->
      <button class="nav-icon-btn" aria-label="Wishlist">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
      </button>
      <!-- Account -->
      <button class="nav-icon-btn" aria-label="Sign in" style="flex-direction:column;gap:2px;width:auto;padding:0 8px;">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
        <span class="nav-icon-label">Sign In</span>
      </button>
      <!-- Cart -->
      <button class="nav-icon-btn" id="cart-toggle-btn" aria-label="Shopping cart" onclick="openCart()">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>
        <span class="cart-count-badge" id="cart-count-badge" data-count="0">0</span>
      </button>
    </div>
  </nav>

</header>

<!-- Breadcrumb + H1 -->
<div class="breadcrumb-bar">
  <nav class="breadcrumb" aria-label="Breadcrumb">
    <a href="#">All Products</a>
    <span class="breadcrumb-sep" aria-hidden="true">â€º</span>
    <a href="#">T-shirts</a>
    <span class="breadcrumb-sep" aria-hidden="true">â€º</span>
    <span aria-current="page">Short Sleeve T-shirts</span>
  </nav>
  <h1 class="page-h1">Custom Short Sleeve T-Shirts</h1>
</div>

<!-- Page Body -->
<div class="page-body">

  <!-- Sidebar Filters -->
  <aside class="filter-sidebar" aria-label="Product filters">

    <!-- Category nav -->
    <div class="sidebar-section">
      <div class="sidebar-section-header" style="font-weight:600;border-bottom:none;padding-bottom:0;">T-shirts</div>
      <ul class="sidebar-cat-list" role="list">
        <li><a href="#" class="active" aria-current="page">Short Sleeve T-shirts</a></li>
        <li><a href="#">Long Sleeve T-shirts</a></li>
        <li><a href="#">Soft Tri-Blend T-shirts</a></li>
        <li><a href="#">Performance Shirts</a></li>
        <li><a href="#">Women's T-shirts</a></li>
        <li><a href="#">Kids T-shirts</a></li>
        <li><a href="#">Heavyweight T-shirts</a></li>
        <li><a href="#">Tie-Dye T-shirts</a></li>
        <li><a href="#">Tank Tops &amp; Sleeveless</a></li>
      </ul>
      <span class="sidebar-show-more">Show more <span aria-hidden="true">â€º</span></span>
    </div>

    <!-- No Minimum toggle -->
    <div class="no-min-row">
      <span>No Minimum</span>
      <label class="ios-toggle" aria-label="Filter: No Minimum">
        <input type="checkbox" />
        <span class="ios-track"></span>
      </label>
    </div>

    <!-- Color Family -->
    <div class="sidebar-section">
      <div class="sidebar-section-header">Color Family <span class="sidebar-section-toggle">âˆ’</span></div>
      <div class="swatch-grid" role="list" aria-label="Color filter swatches">
        <span class="swatch" style="background:#111" title="Black" role="listitem" tabindex="0"></span>
        <span class="swatch" style="background:#1a2f6e" title="Navy" role="listitem" tabindex="0"></span>
        <span class="swatch" style="background:#f8f8f8;border-color:#ccc" title="White" role="listitem" tabindex="0"></span>
        <span class="swatch" style="background:#888" title="Gray" role="listitem" tabindex="0"></span>
        <span class="swatch" style="background:#198038" title="Green" role="listitem" tabindex="0"></span>
        <span class="swatch" style="background:#cc0000" title="Red" role="listitem" tabindex="0"></span>
        <span class="swatch" style="background:#f9a8d4" title="Pink" role="listitem" tabindex="0"></span>
        <span class="swatch" style="background:#5e3b8c" title="Purple" role="listitem" tabindex="0"></span>
        <span class="swatch" style="background:#fde047" title="Yellow" role="listitem" tabindex="0"></span>
        <span class="swatch" style="background:#fa3c00" title="Orange" role="listitem" tabindex="0"></span>
        <span class="swatch" style="background:#5c4033" title="Brown" role="listitem" tabindex="0"></span>
        <span class="swatch" style="background:#b0b0b0" title="Heather" role="listitem" tabindex="0"></span>
        <span class="swatch" style="background:#4a6a4f" title="Camo" role="listitem" tabindex="0"></span>
        <span class="swatch" style="background:#7ec8e3" title="Light Blue" role="listitem" tabindex="0"></span>
        <span class="swatch" style="background:#6b2d42" title="Maroon" role="listitem" tabindex="0"></span>
      </div>
      <span class="sidebar-show-more">Show more <span aria-hidden="true">â€º</span></span>
    </div>

    <!-- Rush Delivery -->
    <div class="sidebar-section">
      <div class="sidebar-section-header">Rush Delivery Available <span class="sidebar-section-toggle">âˆ’</span></div>
      <label class="filter-option"><input type="checkbox" /> 3 days <span class="rush-chip">âš¡ Super Rush</span></label>
      <label class="filter-option"><input type="checkbox" /> 1 week <span class="rush-chip">âš¡ Rush</span></label>
      <label class="filter-option"><input type="checkbox" /> 10 days <span class="rush-chip">Rush</span></label>
      <label class="filter-option"><input type="checkbox" /> 12 days <span class="rush-chip">Rush</span></label>
    </div>

    <!-- Brands -->
    <div class="sidebar-section">
      <div class="sidebar-section-header">Brands <span class="sidebar-section-toggle">âˆ’</span></div>
      <label class="filter-option"><input type="checkbox" /> Bella+Canvas <span class="count">24</span></label>
      <label class="filter-option"><input type="checkbox" /> Gildan <span class="count">18</span></label>
      <label class="filter-option"><input type="checkbox" /> Next Level <span class="count">12</span></label>
      <label class="filter-option"><input type="checkbox" /> Comfort Colors <span class="count">9</span></label>
      <label class="filter-option"><input type="checkbox" /> American Apparel <span class="count">8</span></label>
      <label class="filter-option"><input type="checkbox" /> Port &amp; Company <span class="count">6</span></label>
      <span class="sidebar-show-more">Show more <span aria-hidden="true">â€º</span></span>
    </div>

  </aside>

  <!-- Product Main -->
  <main>

    <!-- Toolbar -->
    <div class="product-toolbar">
      <div class="toolbar-left">
        <button class="toolbar-filters-btn" aria-label="Open filters">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><line x1="4" y1="6" x2="20" y2="6"/><line x1="8" y1="12" x2="16" y2="12"/><line x1="11" y1="18" x2="13" y2="18"/></svg>
          Filters (0)
        </button>
        <span class="result-count" id="result-count">10 products in Custom Short Sleeve T-shirts</span>
      </div>
      <div class="sort-control" aria-label="Sort products">
        <span class="sort-label">Sort By: </span>
        <span class="sort-value">Recommended <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" aria-hidden="true"><polyline points="6 9 12 15 18 9"/></svg></span>
      </div>
    </div>

    <!-- Product Grid -->
    <div id="product-grid" role="list" aria-label="Products"></div>

  </main>
</div>

<!-- Footer -->
<footer class="site-footer" aria-label="Site footer">
  <div class="footer-main">
    <div class="footer-logo">
      <a href="#" class="site-logo">
        <img class="ci-logo-img" alt="CustomInk" style="height:36px;width:auto;" />
      </a>
      <div class="footer-social">
        <a href="#" class="footer-social-link" aria-label="Facebook">f</a>
        <a href="#" class="footer-social-link" aria-label="Instagram">ðŸ“·</a>
        <a href="#" class="footer-social-link" aria-label="Pinterest">P</a>
        <a href="#" class="footer-social-link" aria-label="TikTok">â™ª</a>
      </div>
      <p style="font-size:13px;color:var(--text-secondary);">Tell Us What You Think</p>
    </div>
    <div class="footer-col">
      <h6>Company</h6>
      <ul class="footer-links">
        <li><a href="#">Press</a></li>
        <li><a href="#">Partnerships</a></li>
        <li><a href="#">Customer Reviews</a></li>
        <li><a href="#">Blog</a></li>
        <li><a href="#">Store Locations</a></li>
      </ul>
    </div>
    <div class="footer-col">
      <h6>Service Center</h6>
      <ul class="footer-links">
        <li><a href="#">Help Center</a></li>
        <li><a href="#">Track Your Order</a></li>
        <li><a href="#">Get a Quick Quote</a></li>
        <li><a href="#">855-271-2660</a></li>
        <li><a href="#">Live Chat</a></li>
      </ul>
    </div>
  </div>
  <div class="footer-coda">
    <div><a href="#">Custom Products</a> &nbsp;|&nbsp; <a href="#">Promotional Items</a> &nbsp;|&nbsp; <a href="#">Site Map</a></div>
    <div>Custom Ink is your source for custom t-shirts. &nbsp;<a href="#">Privacy Policy</a> &nbsp;|&nbsp; <a href="#">User Agreement</a></div>
    <div>Â© 2026 CustomInk, LLC. All rights reserved.</div>
  </div>
</footer>

<!-- Cart Backdrop + Drawer -->
<div id="cart-backdrop" class="cart-backdrop" onclick="closeCart()" aria-hidden="true"></div>
<div id="cart-drawer" class="cart-drawer" role="dialog" aria-label="Shopping cart" aria-modal="true">
  <div class="cart-drawer-header">
    <div class="cart-drawer-title">
      Your Cart
      <span class="cart-drawer-badge" id="cart-drawer-badge">0</span>
    </div>
    <button class="cart-drawer-close" onclick="closeCart()" aria-label="Close cart">Ã—</button>
  </div>
  <div class="cart-drawer-body">
    <div id="cart-drawer-list">
      <div class="cart-empty-ci">
        <div class="cart-empty-icon">ðŸ›’</div>
        <div>No items yet.</div>
        <div style="font-size:12px;margin-top:6px;color:var(--text-muted);">Items added via agent tools will appear here.</div>
      </div>
    </div>
  </div>
  <div class="cart-drawer-footer">
    <div class="cart-total-ci">
      <span class="cart-total-label-ci">Order Total</span>
      <span class="cart-total-amount-ci" id="cart-drawer-total">$0.00</span>
    </div>
    <button class="btn-checkout">Let's Go â†’</button>
    <p class="cart-hint-ci">Items added via WebMCP agent tools</p>
  </div>
</div>

<!-- Tool Log Panel -->
<div id="tool-log-panel" class="tool-log-panel" role="region" aria-label="Tool Activity Log">
  <div class="tlp-header">
    <div class="tlp-title">
      <span class="live-dot" aria-hidden="true"></span>
      Tool Activity Log
    </div>
    <button class="tlp-close" id="tlp-close-btn" aria-label="Close tool log">Ã—</button>
  </div>
  <div id="tool-log" role="log" aria-live="polite">
    <div class="log-entry log-system">
      <div class="log-header"><span class="log-time">--:--:--</span><span class="log-name">SYSTEM</span></div>
      <span class="log-msg">WebMCP Demo loaded. Waiting for navigator.modelContextâ€¦</span>
    </div>
  </div>
</div>

<!-- Step Debugger Paused Banner -->
<div id="sdb-paused-banner" role="status" aria-live="polite">
  â–  Paused at tool call â€” click <strong>Step</strong> to resume execution
</div>

<!-- Step Debugger Panel -->
<div id="step-debugger" role="region" aria-label="Step Debugger" aria-hidden="true">
  <div class="sdb-topbar">
    <span class="sdb-breakpoint-icon" aria-hidden="true"></span>
    <span class="sdb-title-prefix">Breakpoint:</span>
    <span class="sdb-tool-name" id="sdb-tool-name">â€”</span>
    <span class="sdb-status-badge paused" id="sdb-status-badge">Paused</span>
    <div class="sdb-topbar-right">
      <button class="btn-sdb-runall" id="btn-sdb-runall" title="Disable stepping for remaining tool calls">â–¶â–¶ Run All</button>
      <button class="btn-sdb-step" id="btn-sdb-step" title="Execute this tool call and show the response">â–¶ Step</button>
      <button class="btn-sdb-close" id="btn-sdb-close" aria-label="Close debugger">Ã—</button>
    </div>
  </div>
  <div class="sdb-tab-bar" role="tablist">
    <button class="sdb-tab active" data-tab="request" role="tab" aria-selected="true">Request</button>
    <button class="sdb-tab" data-tab="schema" role="tab" aria-selected="false">Schema</button>
    <button class="sdb-tab" data-tab="explainer" role="tab" aria-selected="false">Explainer</button>
    <button class="sdb-tab" data-tab="response" role="tab" aria-selected="false">Response <span class="sdb-tab-dot" id="sdb-response-dot"></span></button>
  </div>
  <div class="sdb-content">
    <div class="sdb-pane active" data-tab="request" id="sdb-pane-request" role="tabpanel">
      <div class="sdb-pane-row">
        <div class="sdb-pane-col">
          <span class="sdb-json-label">Input Parameters</span>
          <pre class="sdb-json" id="sdb-json-params">â€”</pre>
        </div>
        <div class="sdb-pane-col">
          <span class="sdb-json-label">API Call Shape</span>
          <pre class="sdb-json" id="sdb-json-call-shape">â€”</pre>
        </div>
      </div>
    </div>
    <div class="sdb-pane" data-tab="schema" id="sdb-pane-schema" role="tabpanel">
      <span class="sdb-json-label">inputSchema (JSON Schema for this tool's parameters)</span>
      <pre class="sdb-json" id="sdb-json-schema">â€”</pre>
    </div>
    <div class="sdb-pane" data-tab="explainer" id="sdb-pane-explainer" role="tabpanel">
      <div class="sdb-explainer-tool" id="sdb-explainer-tool-name">â€”</div>
      <div class="sdb-explainer-text" id="sdb-explainer-body"></div>
      <div class="sdb-explainer-params" id="sdb-explainer-params"></div>
    </div>
    <div class="sdb-pane" data-tab="response" id="sdb-pane-response" role="tabpanel">
      <div id="sdb-response-waiting" style="color:var(--text-muted);font-family:var(--font-mono);font-size:12px;padding:4px 0;">
        Click <strong style="color:var(--text-primary);">â–¶ Step</strong> to execute and see the response.
      </div>
      <div id="sdb-response-content" hidden>
        <div class="sdb-response-header"><span class="sdb-response-title">Response JSON</span></div>
        <pre class="sdb-json" id="sdb-json-response">â€”</pre>
        <div class="sdb-what-changed" id="sdb-what-changed" hidden>
          <div class="sdb-what-changed-title">What Changed</div>
          <ul class="sdb-what-changed-list" id="sdb-what-changed-list"></ul>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- === JAVASCRIPT === -->
<script>
// === PRODUCT DATA ===
const IMG = "?autoNegate=1&design=djn0-00by-wu36&digest=000000028&ixbg=%23ffffff&ixfm=jpeg&ixq=60&ixw=270&placeMax=1&placeMaxPct=0.8&placeUseProduct=1&placeUseView=front";
const CDN = "https://mms-images.out.customink.com/mms/images/catalog/";
const PRODUCTS = [

  {
    id:"gildan-64000", name:"Gildan Softstyle Jersey T-Shirt", brand:"Gildan",
    category:"t-shirts", emoji:"ðŸ‘•",
    imgUrl: CDN+"761907e37ed8853449b8b35e41d206d6/colors/176113/views/alt/front_medium_extended.png"+IMG,
    description:"Ultra-soft 4.5 oz. ring-spun cotton. The most popular shirt on the site.",
    badge:"Best Seller", rating:4.8, reviews:12847,
    ecoFriendly:false, rushAvailable:true, noMinimum:false,
    colors:["White","Black","Navy","Royal Blue","Red","Forest Green","Charcoal","Sand","Sport Grey","Maroon"],
    sizes:["XS","S","M","L","XL","2XL","3XL"],
    decorations:["screen-print","dtg","heat-transfer"],
    swatches:["#f8f8f8","#1a1a1a","#001f5b","#2962cc","#cc0000","#1a5c2a","#4a4a4a","#c2b280"],
    priceTiers:[{min:12,max:23,unitPrice:9.80},{min:24,max:47,unitPrice:9.10},{min:48,max:99,unitPrice:8.60},{min:100,max:299,unitPrice:7.90},{min:300,max:9999,unitPrice:6.95}],
    decorationCosts:{"screen-print":1.50,"dtg":3.00,"heat-transfer":2.00}
  },
  {
    id:"bc-3001", name:"Bella+Canvas Unisex Jersey Tee", brand:"Bella+Canvas",
    category:"t-shirts", emoji:"ðŸ‘•",
    imgUrl: CDN+"colors/124218/views/alt/front_medium_extended.png"+IMG,
    description:"Airlume combed and ring-spun cotton. The premium choice for soft, fitted comfort.",
    badge:"Customer Fave", rating:4.7, reviews:8923,
    ecoFriendly:true, rushAvailable:true, noMinimum:false,
    colors:["Black","White","Navy","Athletic Heather","Dark Grey Heather","True Royal","Charity Pink","Team Purple","Soft Cream","Lavender"],
    sizes:["XS","S","M","L","XL","2XL"],
    decorations:["screen-print","dtg","heat-transfer"],
    swatches:["#1a1a1a","#f8f8f8","#001f5b","#9b9b9b","#555","#2962cc","#f4a7b9","#6b3fa0"],
    priceTiers:[{min:12,max:23,unitPrice:12.40},{min:24,max:47,unitPrice:11.30},{min:48,max:99,unitPrice:10.50},{min:100,max:299,unitPrice:9.70},{min:300,max:9999,unitPrice:8.60}],
    decorationCosts:{"screen-print":1.50,"dtg":3.00,"heat-transfer":2.00}
  },
  {
    id:"comfort-colors-1717", name:"Comfort Colors Garment-Dyed Tee", brand:"Comfort Colors",
    category:"t-shirts", emoji:"ðŸ‘•",
    imgUrl: CDN+"5fcee32759082875e5d410869e323068/colors/175869/views/alt/front_medium_extended.png"+IMG,
    description:"Garment-dyed for a lived-in vintage look. Heavyweight, relaxed fit with standout color.",
    badge:null, rating:4.9, reviews:5431,
    ecoFriendly:false, rushAvailable:false, noMinimum:false,
    colors:["Ivory","Pepper","Blue Jean","Crimson","Moss","Maroon","Sand","Chalky Mint","Yam","Violet"],
    sizes:["S","M","L","XL","2XL","3XL"],
    decorations:["screen-print","dtg","heat-transfer"],
    swatches:["#fffff0","#5c4033","#4a6fa5","#a00000","#6b7c45","#800000","#c2b280","#a8d8bb"],
    priceTiers:[{min:12,max:23,unitPrice:13.80},{min:24,max:47,unitPrice:12.60},{min:48,max:99,unitPrice:11.50},{min:100,max:299,unitPrice:10.40},{min:300,max:9999,unitPrice:9.30}],
    decorationCosts:{"screen-print":1.50,"dtg":3.00,"heat-transfer":2.00}
  },
  {
    id:"nexlevel-3600", name:"Next Level Cotton Crew Tee", brand:"Next Level",
    category:"t-shirts", emoji:"ðŸ‘•",
    imgUrl: CDN+"colors/186901/views/alt/front_medium_extended.png"+IMG,
    description:"60/40 combed ring-spun cotton/polyester. Lightweight with incredible drape.",
    badge:null, rating:4.6, reviews:4102,
    ecoFriendly:false, rushAvailable:false, noMinimum:false,
    colors:["Black","White","Natural","Kelly Green","Hot Pink","Vintage Black","Cool Blue","Banana Cream"],
    sizes:["XS","S","M","L","XL","2XL"],
    decorations:["screen-print","dtg","heat-transfer"],
    swatches:["#1a1a1a","#f8f8f8","#f5e6c8","#198038","#e91e84","#2a2a2a","#4a90d9","#fef3c7"],
    priceTiers:[{min:12,max:23,unitPrice:11.20},{min:24,max:47,unitPrice:10.30},{min:48,max:99,unitPrice:9.60},{min:100,max:299,unitPrice:8.90},{min:300,max:9999,unitPrice:7.80}],
    decorationCosts:{"screen-print":1.50,"dtg":3.00,"heat-transfer":2.00}
  },
  {
    id:"gildan-5000", name:"Gildan Heavy Cotton T-Shirt", brand:"Gildan",
    category:"t-shirts", emoji:"ðŸ‘•",
    imgUrl: CDN+"e0889a8662a4244074877e80a9f7f175/colors/4102/views/alt/front_medium_extended.png"+IMG,
    description:"Classic 5.3 oz. 100% cotton. Reliable, durable, and extremely affordable.",
    badge:"Best Seller", rating:4.5, reviews:9321,
    ecoFriendly:false, rushAvailable:true, noMinimum:true,
    colors:["Black","White","Navy","Royal","Red","Dark Heather","Irish Green","Sand","Antique Cherry Red","Safety Green"],
    sizes:["S","M","L","XL","2XL","3XL","4XL","5XL"],
    decorations:["screen-print","heat-transfer"],
    swatches:["#1a1a1a","#f8f8f8","#001f5b","#2962cc","#cc0000","#5a5a5a","#2d7a3a","#c9b57a"],
    priceTiers:[{min:12,max:23,unitPrice:7.50},{min:24,max:47,unitPrice:6.90},{min:48,max:99,unitPrice:6.40},{min:100,max:299,unitPrice:5.90},{min:300,max:9999,unitPrice:5.15}],
    decorationCosts:{"screen-print":1.50,"heat-transfer":2.00}
  },
  {
    id:"aa-2001w", name:"American Apparel Fine Jersey Tee", brand:"American Apparel",
    category:"t-shirts", emoji:"ðŸ‘•",
    imgUrl: CDN+"e00c1f0752cc2b408a43deb88a7426f4/colors/172321/views/alt/front_medium_extended.png"+IMG,
    description:"Ultra-fine 4.3 oz. combed and ring-spun cotton. Made in USA.",
    badge:"Staff Pick", rating:4.7, reviews:2841,
    ecoFriendly:true, rushAvailable:false, noMinimum:false,
    colors:["Black","White","Heather Grey","Lemon","Pink","Baby Blue","Army","Asphalt","Cranberry","Forest"],
    sizes:["XS","S","M","L","XL","2XL"],
    decorations:["screen-print","dtg","heat-transfer"],
    swatches:["#1a1a1a","#f8f8f8","#b0b0b0","#ffe066","#f9a8d4","#bfdbfe","#6b7c52","#4a4a4a"],
    priceTiers:[{min:12,max:23,unitPrice:14.20},{min:24,max:47,unitPrice:13.10},{min:48,max:99,unitPrice:12.20},{min:100,max:299,unitPrice:11.30},{min:300,max:9999,unitPrice:9.90}],
    decorationCosts:{"screen-print":1.50,"dtg":3.00,"heat-transfer":2.00}
  },
  {
    id:"pc-54", name:"Port & Company Core Cotton Tee", brand:"Port & Company",
    category:"t-shirts", emoji:"ðŸ‘•",
    imgUrl: CDN+"096f8118a1e6fecfc262ff4d28fc4f98/colors/4929/views/alt/front_medium_extended.png"+IMG,
    description:"6.1 oz. 100% cotton. Sturdy and consistent for large orders.",
    badge:null, rating:4.4, reviews:3190,
    ecoFriendly:false, rushAvailable:true, noMinimum:false,
    colors:["Black","White","Navy","Royal","Red","Athletic Heather","Bright Green","Maroon","Orange","Yellow"],
    sizes:["S","M","L","XL","2XL","3XL","4XL"],
    decorations:["screen-print","heat-transfer"],
    swatches:["#1a1a1a","#f8f8f8","#001f5b","#2962cc","#cc0000","#9b9b9b","#22c55e","#6b2d42"],
    priceTiers:[{min:12,max:23,unitPrice:8.90},{min:24,max:47,unitPrice:8.20},{min:48,max:99,unitPrice:7.70},{min:100,max:299,unitPrice:7.10},{min:300,max:9999,unitPrice:6.20}],
    decorationCosts:{"screen-print":1.50,"heat-transfer":2.00}
  },
  {
    id:"allmade-al2004", name:"Allmade Unisex Organic Tee", brand:"Allmade",
    category:"t-shirts", emoji:"ðŸ‘•",
    imgUrl: CDN+"7f6d6c6b44010508073c972525a9abab/colors/1790623/views/alt/front_medium_extended.png?autoNegate=1&design=djn0-00by-wu36&digest=000000028&ixbg=%23ffffff&ixfm=jpeg&ixq=60&ixw=270&placeMax=1&placeMaxPct=1&placeUseGuideline=pocket&placeUseProduct=1&placeUseView=front",
    description:"50% TENCEL Modal, 25% recycled poly, 25% organic cotton. Ultra-sustainable.",
    badge:null, rating:4.8, reviews:1204,
    ecoFriendly:true, rushAvailable:false, noMinimum:false,
    colors:["Aluminum Grey","Bone White","Rise Up Red","Tri-Blend Sky","Make Green Happen","Ozone Blue"],
    sizes:["XS","S","M","L","XL","2XL","3XL"],
    decorations:["screen-print","dtg"],
    swatches:["#9e9e9e","#f5f0e8","#da1e28","#7ec8e3","#198038","#1e88e5"],
    priceTiers:[{min:12,max:23,unitPrice:18.50},{min:24,max:47,unitPrice:17.20},{min:48,max:99,unitPrice:16.10},{min:100,max:299,unitPrice:15.00},{min:300,max:9999,unitPrice:13.20}],
    decorationCosts:{"screen-print":1.50,"dtg":3.00}
  },
  {
    id:"bc-3001cvc", name:"Bella+Canvas Heather CVC Tee", brand:"Bella+Canvas",
    category:"t-shirts", emoji:"ðŸ‘•",
    imgUrl: CDN+"3d19112e680403aab717b4d42f58aeb3/colors/242010/views/alt/front_medium_extended.png"+IMG,
    description:"52% combed ring-spun cotton/48% polyester. Super soft heathered blends.",
    badge:"Customer Fave", rating:4.7, reviews:3672,
    ecoFriendly:false, rushAvailable:true, noMinimum:false,
    colors:["Heather Navy","Heather Red","Heather Grey","Heather Forest","Heather Maroon","Heather Olive","Heather Slate","Heather Dark Chocolate"],
    sizes:["XS","S","M","L","XL","2XL"],
    decorations:["screen-print","dtg","heat-transfer"],
    swatches:["#2a3f6e","#b5334e","#8a8a8a","#2d5a3d","#6b2d42","#5c6e3a","#5a6e7a","#3d2b1f"],
    priceTiers:[{min:12,max:23,unitPrice:13.20},{min:24,max:47,unitPrice:12.10},{min:48,max:99,unitPrice:11.30},{min:100,max:299,unitPrice:10.40},{min:300,max:9999,unitPrice:9.10}],
    decorationCosts:{"screen-print":1.50,"dtg":3.00,"heat-transfer":2.00}
  },
  {
    id:"hanes-5250", name:"Hanes Authentic Tee", brand:"Hanes",
    category:"t-shirts", emoji:"ðŸ‘•",
    imgUrl: CDN+"57494ecaa0e6f8f3dd6e3966d67e2917/colors/116204/views/alt/front_medium_extended.png"+IMG,
    description:"6.1 oz. 100% pre-shrunk cotton. Tagless comfort for maximum wearability.",
    badge:"Best Seller", rating:4.4, reviews:6203,
    ecoFriendly:false, rushAvailable:false, noMinimum:true,
    colors:["Black","White","Deep Red","Deep Navy","Smoke Grey","Yellow Haze","Denim Blue","Fatigue Green","Purple","Ash"],
    sizes:["S","M","L","XL","2XL","3XL"],
    decorations:["screen-print","heat-transfer"],
    swatches:["#1a1a1a","#f8f8f8","#8b1a1a","#1a2f6e","#6b6b6b","#fef3c7","#4a90d9","#4a5e3a"],
    priceTiers:[{min:12,max:23,unitPrice:8.20},{min:24,max:47,unitPrice:7.60},{min:48,max:99,unitPrice:7.00},{min:100,max:299,unitPrice:6.50},{min:300,max:9999,unitPrice:5.60}],
    decorationCosts:{"screen-print":1.50,"heat-transfer":2.00}
  }
];

// === CART STATE ===
let cart = [];
let cartIdCounter = 0;

// === HELPERS ===
function escapeHtml(s){return String(s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");}
function formatJSON(v){try{return JSON.stringify(v,null,2);}catch(_){return String(v);}}
function findProduct(id){return PRODUCTS.find(p=>p.id===id)||null;}
function findTier(p,qty){return p.priceTiers.find(t=>qty>=t.min&&qty<=t.max)||null;}
function toPublicShape(p){return{id:p.id,name:p.name,brand:p.brand,category:p.category,description:p.description,colors:p.colors,sizes:p.sizes,decorations:p.decorations,emoji:p.emoji};}
function starsHtml(r){const f=Math.round(r*2)/2;let h="";for(let i=1;i<=5;i++){if(i<=f)h+="â˜…";else if(i-0.5<=f)h+="â˜…";else h+="â˜†";}return h;}
function fmtReviews(n){return n>=10000?"(10,000+)":`(${n.toLocaleString()})`;}

// === RENDER PRODUCTS ===
const DECOR_LABELS={"screen-print":"Screen Print","embroidery":"Embroidery","dtg":"DTG","heat-transfer":"Heat Transfer"};

window.renderProducts = function(products){
  const grid=document.getElementById("product-grid");
  if(!grid)return;
  const rc=document.getElementById("result-count");
  if(rc)rc.textContent=`${products.length} products in Custom Short Sleeve T-shirts`;
  if(!products||products.length===0){
    grid.innerHTML='<p style="grid-column:1/-1;text-align:center;color:var(--text-secondary);padding:40px 0;">No products found.</p>';
    return;
  }
  grid.innerHTML=products.map(p=>{
    const lowestPrice=p.priceTiers[0].unitPrice;
    const maxQtyPrice=p.priceTiers[p.priceTiers.length-1];
    const swatchHtml=p.swatches.slice(0,8).map(c=>
      `<span class="ci-swatch" style="background:${c}" title="${escapeHtml(c)}"></span>`
    ).join("") + (p.colors.length>8?`<span class="ci-swatch-more">+${p.colors.length-8}</span>`:"");
    const badge=p.badge?`<div class="ci-badge">${escapeHtml(p.badge)}</div>`:"";
    const eco=p.ecoFriendly?`<div class="ci-eco">ðŸŒ¿ Eco</div>`:"";
    const rush=p.rushAvailable?`<div class="ci-rush-chip">âš¡ 3-Day Rush Available</div>`:"";
    const noMin=p.noMinimum?`<div class="ci-no-min">No Minimum</div>`:"";
    return `
    <article class="ci-card" role="listitem" data-id="${p.id}">
      <div class="ci-card-img-wrap">
        ${badge}
        <div class="ci-card-img" style="padding:0;overflow:hidden;">
          <img src="${escapeHtml(p.imgUrl||'')}" alt="${escapeHtml(p.name)}" loading="lazy" style="width:100%;height:100%;object-fit:contain;display:block;" onerror="this.style.display='none';this.nextElementSibling.style.display='flex';" />
          <div style="display:none;width:100%;height:100%;flex-direction:column;align-items:center;justify-content:center;gap:8px;font-size:80px;"><span>${p.emoji}</span><span style="font-size:12px;letter-spacing:.1em;color:rgba(0,0,0,.13);font-weight:600">Your Design Here</span></div>
        </div>
        ${eco}
        <div class="ci-wishlist" role="button" tabindex="0" aria-label="Add to wishlist">â™¡</div>
      </div>
      <div class="ci-card-body">
        <div class="ci-swatches">${swatchHtml}</div>
        <div class="ci-card-name"><a href="#">${escapeHtml(p.name)}</a></div>
        <div class="ci-rating">
          <span class="ci-stars">${starsHtml(p.rating)}</span>
          <span class="ci-rating-score">${p.rating}</span>
          <span class="ci-rating-count">${fmtReviews(p.reviews)}</span>
        </div>
        <div class="ci-price">$${lowestPrice.toFixed(2)}/ea for ${maxQtyPrice.max>=9999?"500+":maxQtyPrice.max} items</div>
        <div><a href="#" class="ci-price-link">Pricing Details</a></div>
        ${rush}${noMin}
      </div>
    </article>`;
  }).join("");
};

// === RENDER CART ===
window.renderCart = function(cartData){
  const list=document.getElementById("cart-drawer-list");
  const total=document.getElementById("cart-drawer-total");
  const badge=document.getElementById("cart-drawer-badge");
  const navBadge=document.getElementById("cart-count-badge");

  const totalQty=cartData.reduce((s,i)=>s+i.quantity,0);
  const totalPrice=cartData.reduce((s,i)=>s+i.lineTotal,0);

  if(badge)badge.textContent=String(totalQty);
  if(total)total.textContent="$"+totalPrice.toFixed(2);
  if(navBadge){navBadge.textContent=String(totalQty);navBadge.setAttribute("data-count",String(totalQty));}
  if(!list)return;

  if(cartData.length===0){
    list.innerHTML=`<div class="cart-empty-ci"><div class="cart-empty-icon">ðŸ›’</div><div>No items yet.</div><div style="font-size:12px;margin-top:6px;color:var(--text-muted);">Items added via agent tools will appear here.</div></div>`;
    return;
  }
  list.innerHTML=cartData.map(item=>{
    const p=findProduct(item.productId);
    return `<div class="cart-item-ci">
      <span class="cart-item-emoji">${p?p.emoji:"ðŸ‘•"}</span>
      <div class="cart-item-info">
        <div class="cart-item-name-ci">${escapeHtml(item.name)}</div>
        <div class="cart-item-meta-ci">${escapeHtml(item.color)} Â· ${escapeHtml(item.size)}</div>
        <div class="cart-item-meta-ci">${DECOR_LABELS[item.decoration]||item.decoration} Â· Qty ${item.quantity}</div>
        <div class="cart-item-meta-ci" style="opacity:0.65;font-size:10px;">$${item.unitPrice.toFixed(2)}/ea + $${item.decorationCost.toFixed(2)} deco</div>
      </div>
      <div class="cart-item-price-ci">$${item.lineTotal.toFixed(2)}</div>
    </div>`;
  }).join("");
};

// === CART OPEN / CLOSE ===
function openCart(){
  document.getElementById("cart-backdrop").classList.add("open");
  document.getElementById("cart-drawer").classList.add("open");
}
function closeCart(){
  document.getElementById("cart-backdrop").classList.remove("open");
  document.getElementById("cart-drawer").classList.remove("open");
}
window.openCart=openCart;
window.closeCart=closeCart;

// === TOOL LOG ===
window.logToolCall = function(name,params,result,isError,durationMs){
  const container=document.getElementById("tool-log");
  if(!container)return;
  const now=new Date();
  const ts=[now.getHours(),now.getMinutes(),now.getSeconds()].map(n=>String(n).padStart(2,"0")).join(":")+"."+String(now.getMilliseconds()).padStart(3,"0");
  const entry=document.createElement("div");
  if(name==="SYSTEM"){
    entry.className="log-entry log-system";
    const msg=result?.message??JSON.stringify(result);
    entry.innerHTML=`<div class="log-header"><span class="log-time">${escapeHtml(ts)}</span><span class="log-name">SYSTEM</span></div><span class="log-msg">${escapeHtml(msg)}</span>`;
  } else {
    entry.className=`log-entry ${isError?"log-error":"log-call"}`;
    const errBadge=isError?`<span style="background:#da1e28;color:#fff;font-size:9px;padding:1px 5px;border-radius:3px;font-weight:700;line-height:1.4;">ERR</span>`:"";
    entry.innerHTML=`<div class="log-header"><span class="log-time">${escapeHtml(ts)}</span><span class="log-name">${escapeHtml(name)}</span>${errBadge}<span class="log-duration">${durationMs}ms</span></div>
    <details><summary style="cursor:pointer;color:var(--text-muted);font-size:10px;list-style:none;padding:2px 0;">â–¸ params</summary><div class="log-params">${escapeHtml(formatJSON(params))}</div></details>
    <details ${isError?"open":""}><summary style="cursor:pointer;color:var(--text-muted);font-size:10px;list-style:none;padding:2px 0;">â–¸ ${isError?"error":"result"}</summary><div class="${isError?"log-params":"log-result"}" style="${isError?"border-left-color:#da1e28;background:rgba(218,30,40,0.05);color:#da1e28;":""}">${escapeHtml(formatJSON(result))}</div></details>`;
  }
  container.appendChild(entry);
  container.scrollTop=container.scrollHeight;
};

// === AGENT STATUS ===
let _agentTimer=null;
window.setAgentActive=function(bool){
  const el=document.getElementById("agent-status");
  if(!el)return;
  const lbl=el.querySelector(".status-label");
  if(bool){
    if(_agentTimer){clearTimeout(_agentTimer);_agentTimer=null;}
    el.classList.add("active");
    if(lbl)lbl.textContent="Active";
  } else {
    if(_agentTimer)clearTimeout(_agentTimer);
    _agentTimer=setTimeout(()=>{
      el.classList.remove("active");
      if(lbl)lbl.textContent="Idle";
      _agentTimer=null;
    },2000);
  }
};

// === TOOL LOG TOGGLE ===
document.addEventListener("DOMContentLoaded",()=>{
  const toggleBtn=document.getElementById("tool-log-toggle");
  const panel=document.getElementById("tool-log-panel");
  const closeBtn=document.getElementById("tlp-close-btn");
  function openLog(){panel.classList.add("open");toggleBtn.classList.add("active");}
  function closeLog(){panel.classList.remove("open");toggleBtn.classList.remove("active");}
  if(toggleBtn)toggleBtn.addEventListener("click",()=>panel.classList.contains("open")?closeLog():openLog());
  if(closeBtn)closeBtn.addEventListener("click",closeLog);
});

// === TOOL EXPLAINERS ===
const TOOL_EXPLAINERS={
  searchProducts:{
    summary:"The agent is searching the product catalog.",
    body:`<p><strong>searchProducts</strong> queries the CustomInk-style catalog and returns matching products. The agent typically calls this first to discover product IDs, available colors, sizes, and decoration methods before placing a quote or cart request.</p><p>The browser intercepts this call via <code style="font-family:var(--font-mono);background:var(--bg-raised);padding:1px 4px;border-radius:3px;">navigator.modelContext</code>, routes it to this page's registered handler, and relays the response back to the agent.</p>`,
    paramDocs:{query:"Free-text search against product name, brand, and description.",category:"Restrict results to a category: t-shirts, hoodies, hats, etc."}
  },
  configureProduct:{
    summary:"The agent is validating a product + color + size combination.",
    body:`<p><strong>configureProduct</strong> checks that the chosen color and size exist for this product â€” like selecting a specific variant from a product page dropdown. Returns the starting unit price and available decoration methods.</p>`,
    paramDocs:{productId:"Product ID from searchProducts (e.g. 'gildan-64000').",color:"Must be an exact match from the product's colors array.",size:"Must be an exact match from the product's sizes array."}
  },
  getQuote:{
    summary:"The agent is calculating a price quote â€” no cart changes happen here.",
    body:`<p><strong>getQuote</strong> applies quantity-based pricing tiers and adds decoration cost (screen printing, DTG, heat transfer). Returns a full line-item breakdown. This is read-only â€” nothing is added to the cart.</p>`,
    paramDocs:{productId:"Product ID.",quantity:"Number of items. Minimum 12.",color:"Exact color name.",size:"Exact size.",decoration:"screen-print, dtg, or heat-transfer."}
  },
  addToCart:{
    summary:"The agent is adding an item to the cart â€” this will update the UI live.",
    body:`<p><strong>addToCart</strong> runs the same validation as getQuote, then appends the item to the in-page cart and calls <code style="font-family:var(--font-mono);background:var(--bg-raised);padding:1px 4px;border-radius:3px;">renderCart()</code> to update the cart drawer in real time. This is the only tool that mutates page state.</p>`,
    paramDocs:{productId:"Product ID.",quantity:"Minimum 12.",color:"Exact color.",size:"Exact size.",decoration:"Decoration method."}
  },
  getCart:{
    summary:"The agent is reading the current cart â€” read-only snapshot.",
    body:`<p><strong>getCart</strong> is read-only. Returns the full cart array, total item count, and order total. No state is changed. The agent uses this to verify or summarize what has been added.</p>`,
    paramDocs:{}
  }
};

// === STEP DEBUGGER ===
const stepDebugger=(function(){
  let _on=false,_runAll=false,_resolve=null,_cur=null;
  const panel=()=>document.getElementById("step-debugger");
  const banner=()=>document.getElementById("sdb-paused-banner");

  function openPanel(){const p=panel();if(!p)return;p.classList.add("open","paused");p.classList.remove("complete");p.removeAttribute("aria-hidden");document.body.classList.add("sdb-panel-open");const b=banner();if(b)b.classList.add("visible");}
  function closePanel(){const p=panel();if(!p)return;p.classList.remove("open","paused","complete");p.setAttribute("aria-hidden","true");document.body.classList.remove("sdb-panel-open");const b=banner();if(b)b.classList.remove("visible");}
  function markComplete(){const p=panel();if(!p)return;p.classList.remove("paused");p.classList.add("complete");const b=document.getElementById("sdb-status-badge");if(b){b.textContent="Complete";b.className="sdb-status-badge complete";}}

  function switchTab(name){
    document.querySelectorAll(".sdb-tab").forEach(btn=>{const a=btn.dataset.tab===name;btn.classList.toggle("active",a);btn.setAttribute("aria-selected",String(a));});
    document.querySelectorAll(".sdb-pane").forEach(p=>p.classList.toggle("active",p.dataset.tab===name));
  }

  function populateRequest(toolName,params,schema){
    const tn=document.getElementById("sdb-tool-name");if(tn)tn.textContent=toolName+"()";
    const sb=document.getElementById("sdb-status-badge");if(sb){sb.textContent="Paused";sb.className="sdb-status-badge paused";}
    const pe=document.getElementById("sdb-json-params");if(pe)pe.textContent=formatJSON(params);
    const ce=document.getElementById("sdb-json-call-shape");if(ce)ce.textContent=formatJSON({"navigator.modelContext":{method:"execute",tool:toolName,params}});
    const se=document.getElementById("sdb-json-schema");if(se)se.textContent=formatJSON(schema);
    const expl=TOOL_EXPLAINERS[toolName]||{summary:`Tool: ${toolName}`,body:`<p>No explainer available.</p>`,paramDocs:{}};
    const et=document.getElementById("sdb-explainer-tool-name");if(et)et.textContent=toolName+"() â€” "+expl.summary;
    const eb=document.getElementById("sdb-explainer-body");if(eb)eb.innerHTML=expl.body;
    const pc=document.getElementById("sdb-explainer-params");
    if(pc){const ks=Object.keys(params);if(ks.length===0){pc.innerHTML='<span style="font-size:11px;color:var(--text-muted);font-family:var(--font-mono);">No parameters.</span>';}else{pc.innerHTML=ks.map(k=>`<div class="sdb-param-row"><span class="sdb-param-name">${escapeHtml(k)}</span><span class="sdb-param-value">${escapeHtml(String(params[k]))}</span>${expl.paramDocs[k]?`<span style="font-size:10px;color:var(--text-muted);margin-left:auto;">${escapeHtml(expl.paramDocs[k])}</span>`:""}</div>`).join("");}}
    const rw=document.getElementById("sdb-response-waiting");if(rw)rw.hidden=false;
    const rc2=document.getElementById("sdb-response-content");if(rc2)rc2.hidden=true;
    const rd=document.getElementById("sdb-response-dot");if(rd)rd.style.opacity="0";
    const rt=document.querySelector('.sdb-tab[data-tab="response"]');if(rt)rt.classList.remove("has-data");
    const s=document.getElementById("btn-sdb-step");if(s){s.disabled=false;s.textContent="â–¶ Step";}
  }

  function buildWhatChanged(toolName,result){
    const lines=[];if(!result||typeof result!=="object")return lines;
    try{
      if(toolName==="searchProducts"){const c=result.count??result.products?.length??0;lines.push(`${c} product(s) returned`);if(result.products?.length>0)lines.push(`First result: ${result.products[0].name}`);}
      else if(toolName==="configureProduct"){if(result.available){lines.push(`Config valid: ${result.color}, ${result.size}`);lines.push(`Unit price: $${result.unitPrice?.toFixed(2)}`);}}
      else if(toolName==="getQuote"){if(result.unitTotal!==undefined){lines.push(`Unit total: $${result.unitTotal?.toFixed(2)}/ea`);lines.push(`Order subtotal: $${result.subtotal?.toFixed(2)} for ${result.quantity} pcs`);}}
      else if(toolName==="addToCart"){if(result.success){lines.push(`Cart item added (#${result.cartItemId})`);lines.push(`New order total: $${result.orderTotal} (${result.itemCount} pcs)`);lines.push("Cart drawer updated in real time");}}
      else if(toolName==="getCart"){lines.push(`Cart: ${result.itemCount??0} item(s), total $${result.orderTotal??"0.00"}`);}
    }catch(_){}
    return lines;
  }

  function populateResponse(toolName,result,isError){
    const rw=document.getElementById("sdb-response-waiting");if(rw)rw.hidden=true;
    const rc2=document.getElementById("sdb-response-content");if(rc2)rc2.hidden=false;
    const jr=document.getElementById("sdb-json-response");
    if(jr){jr.textContent=formatJSON(result);jr.style.borderLeftColor=isError?"var(--accent-red)":"rgba(25,128,56,0.3)";jr.style.background=isError?"rgba(218,30,40,0.04)":"";jr.style.color=isError?"var(--accent-red)":"";}
    const changes=buildWhatChanged(toolName,result);
    const wc=document.getElementById("sdb-what-changed");const wcl=document.getElementById("sdb-what-changed-list");
    if(wc&&wcl&&changes.length>0){wc.hidden=false;wcl.innerHTML=changes.map(c=>`<li>${escapeHtml(c)}</li>`).join("");}else if(wc)wc.hidden=true;
    const rd=document.getElementById("sdb-response-dot");if(rd)rd.style.opacity="1";
    const rt=document.querySelector('.sdb-tab[data-tab="response"]');if(rt)rt.classList.add("has-data");
    switchTab("response");
    const s=document.getElementById("btn-sdb-step");if(s){s.disabled=true;s.textContent="Stepped";}
    markComplete();
  }

  async function intercept(toolName,params,schema){
    _cur=toolName;
    if(!_on||_runAll)return;
    populateRequest(toolName,params,schema);
    switchTab("request");
    openPanel();
    await new Promise(res=>{_resolve=res;});
    _resolve=null;
  }

  function showResponse(toolName,result,isError){
    if(!_on||_runAll)return;
    populateResponse(toolName,result,isError);
  }

  function init(){
    const cb=document.getElementById("learning-mode-checkbox");
    if(cb)cb.addEventListener("change",e=>{_on=e.target.checked;_runAll=false;if(!_on){if(_resolve)_resolve();closePanel();}});
    const sb=document.getElementById("btn-sdb-step");
    if(sb)sb.addEventListener("click",()=>{if(_resolve){sb.disabled=true;sb.textContent="Steppingâ€¦";_resolve();}});
    const rb=document.getElementById("btn-sdb-runall");
    if(rb)rb.addEventListener("click",()=>{_runAll=true;rb.textContent="â–¶â–¶ Runningâ€¦";rb.disabled=true;if(_resolve)_resolve();setTimeout(closePanel,800);});
    const xb=document.getElementById("btn-sdb-close");
    if(xb)xb.addEventListener("click",()=>{if(_resolve)_resolve();closePanel();});
    document.querySelectorAll(".sdb-tab").forEach(btn=>btn.addEventListener("click",()=>{if(!btn.classList.contains("disabled"))switchTab(btn.dataset.tab);}));
  }

  return{intercept,showResponse,init,isActive:()=>_on&&!_runAll};
})();
window.stepDebugger=stepDebugger;

// === TOOL REGISTRATION ===
window.registerAllTools = function(){
  // searchProducts
  window.navigator.modelContext.registerTool({
    name:"searchProducts",
    description:"Search and filter the product catalog. Returns matching products with IDs, colors, sizes, and decoration options.",
    inputSchema:{type:"object",properties:{query:{type:"string",description:"Search term matched against product name, brand, description."},category:{type:"string",enum:["t-shirts","hoodies","hats","long-sleeves","sweatshirts"],description:"Filter to one category."}},required:[]},
    async execute(params,agent){
      window.setAgentActive(true);const start=Date.now();
      await window.stepDebugger.intercept("searchProducts",params,this.inputSchema);
      let result,isError=false;
      try{
        const{query,category}=params;let matches=PRODUCTS.slice();
        if(query?.trim()){const q=query.toLowerCase();matches=matches.filter(p=>p.name.toLowerCase().includes(q)||p.brand.toLowerCase().includes(q)||p.description.toLowerCase().includes(q));}
        if(category?.trim())matches=matches.filter(p=>p.category===category.trim());
        result={products:matches.map(toPublicShape),count:matches.length};
      }catch(err){isError=true;result={error:err.message};window.stepDebugger.showResponse("searchProducts",result,true);window.logToolCall("searchProducts",params,result,true,Date.now()-start);window.setAgentActive(false);throw err;}
      window.stepDebugger.showResponse("searchProducts",result,false);window.logToolCall("searchProducts",params,result,false,Date.now()-start);window.setAgentActive(false);
      return{content:[{type:"text",text:JSON.stringify(result)}]};
    }
  });

  // configureProduct
  window.navigator.modelContext.registerTool({
    name:"configureProduct",
    description:"Validate a product with a specific color and size. Returns available decorations and starting unit price.",
    inputSchema:{type:"object",properties:{productId:{type:"string",description:"Product ID from searchProducts."},color:{type:"string",description:"Exact color name."},size:{type:"string",description:"Exact size."}},required:["productId","color","size"]},
    async execute(params,agent){
      window.setAgentActive(true);const start=Date.now();
      await window.stepDebugger.intercept("configureProduct",params,this.inputSchema);
      let result,isError=false;
      try{
        const{productId,color,size}=params;const p=findProduct(productId);
        if(!p)throw new Error(`Product not found: "${productId}". Call searchProducts first.`);
        if(!p.colors.includes(color))throw new Error(`Color "${color}" not available. Options: ${p.colors.join(", ")}`);
        if(!p.sizes.includes(size))throw new Error(`Size "${size}" not available. Options: ${p.sizes.join(", ")}`);
        result={productId:p.id,name:p.name,color,size,unitPrice:p.priceTiers[0].unitPrice,available:true,availableDecorations:p.decorations};
      }catch(err){isError=true;result={error:err.message};window.stepDebugger.showResponse("configureProduct",result,true);window.logToolCall("configureProduct",params,result,true,Date.now()-start);window.setAgentActive(false);throw err;}
      window.stepDebugger.showResponse("configureProduct",result,false);window.logToolCall("configureProduct",params,result,false,Date.now()-start);window.setAgentActive(false);
      return{content:[{type:"text",text:JSON.stringify(result)}]};
    }
  });

  // getQuote
  window.navigator.modelContext.registerTool({
    name:"getQuote",
    description:"Calculate a price quote with quantity-based tiers and decoration costs. Minimum 12. Read-only â€” does not modify the cart.",
    inputSchema:{type:"object",properties:{productId:{type:"string"},quantity:{type:"number",description:"Min 12."},color:{type:"string"},size:{type:"string"},decoration:{type:"string",enum:["screen-print","embroidery","dtg","heat-transfer"]}},required:["productId","quantity","color","size","decoration"]},
    async execute(params,agent){
      window.setAgentActive(true);const start=Date.now();
      await window.stepDebugger.intercept("getQuote",params,this.inputSchema);
      let result,isError=false;
      try{
        const{productId,quantity,color,size,decoration}=params;const p=findProduct(productId);
        if(!p)throw new Error(`Product not found: "${productId}".`);
        if(!p.colors.includes(color))throw new Error(`Color "${color}" not available.`);
        if(!p.sizes.includes(size))throw new Error(`Size "${size}" not available.`);
        if(!p.decorations.includes(decoration))throw new Error(`Decoration "${decoration}" not available. Options: ${p.decorations.join(", ")}`);
        if(quantity<12)throw new Error(`Minimum quantity is 12. Got: ${quantity}`);
        const tier=findTier(p,quantity);if(!tier)throw new Error(`No price tier for qty ${quantity}.`);
        const unitPrice=tier.unitPrice,decorCost=p.decorationCosts[decoration]||0,unitTotal=unitPrice+decorCost,subtotal=unitTotal*quantity;
        const savings=((p.priceTiers[0].unitPrice-unitPrice)*quantity).toFixed(2);
        result={productId:p.id,name:p.name,color,size,decoration,quantity,unitPrice,decorationCost:decorCost,unitTotal,subtotal,savings,priceBreakdown:`${quantity} pcs @ $${unitPrice.toFixed(2)}/ea + $${decorCost.toFixed(2)} deco = $${unitTotal.toFixed(2)}/ea Â· Total: $${subtotal.toFixed(2)}`};
      }catch(err){isError=true;result={error:err.message};window.stepDebugger.showResponse("getQuote",result,true);window.logToolCall("getQuote",params,result,true,Date.now()-start);window.setAgentActive(false);throw err;}
      window.stepDebugger.showResponse("getQuote",result,false);window.logToolCall("getQuote",params,result,false,Date.now()-start);window.setAgentActive(false);
      return{content:[{type:"text",text:JSON.stringify(result)}]};
    }
  });

  // addToCart
  window.navigator.modelContext.registerTool({
    name:"addToCart",
    description:"Add a configured product to the shopping cart. Updates the cart UI live. Returns updated cart and order total.",
    inputSchema:{type:"object",properties:{productId:{type:"string"},quantity:{type:"number",description:"Min 12."},color:{type:"string"},size:{type:"string"},decoration:{type:"string",enum:["screen-print","embroidery","dtg","heat-transfer"]}},required:["productId","quantity","color","size","decoration"]},
    async execute(params,agent){
      window.setAgentActive(true);const start=Date.now();
      await window.stepDebugger.intercept("addToCart",params,this.inputSchema);
      let result,isError=false;
      try{
        const{productId,quantity,color,size,decoration}=params;const p=findProduct(productId);
        if(!p)throw new Error(`Product not found: "${productId}".`);
        if(!p.colors.includes(color))throw new Error(`Color "${color}" not available.`);
        if(!p.sizes.includes(size))throw new Error(`Size "${size}" not available.`);
        if(!p.decorations.includes(decoration))throw new Error(`Decoration "${decoration}" not available.`);
        if(quantity<12)throw new Error(`Minimum quantity is 12. Got: ${quantity}`);
        const tier=findTier(p,quantity);if(!tier)throw new Error(`No price tier for qty ${quantity}.`);
        const unitPrice=tier.unitPrice,decorCost=p.decorationCosts[decoration]||0,lineTotal=(unitPrice+decorCost)*quantity;
        const item={cartItemId:++cartIdCounter,productId:p.id,name:p.name,color,size,decoration,quantity,unitPrice,decorationCost:decorCost,lineTotal};
        cart.push(item);window.renderCart(cart);
        const itemCount=cart.reduce((s,i)=>s+i.quantity,0),orderTotal=cart.reduce((s,i)=>s+i.lineTotal,0).toFixed(2);
        result={success:true,cartItemId:item.cartItemId,itemAdded:item,cart:cart.slice(),itemCount,orderTotal};
      }catch(err){isError=true;result={error:err.message};window.stepDebugger.showResponse("addToCart",result,true);window.logToolCall("addToCart",params,result,true,Date.now()-start);window.setAgentActive(false);throw err;}
      window.stepDebugger.showResponse("addToCart",result,false);window.logToolCall("addToCart",params,result,false,Date.now()-start);window.setAgentActive(false);
      return{content:[{type:"text",text:JSON.stringify(result)}]};
    }
  });

  // getCart
  window.navigator.modelContext.registerTool({
    name:"getCart",
    description:"Read-only. Returns current cart contents, item count, and order total.",
    inputSchema:{type:"object",properties:{},required:[]},
    async execute(params,agent){
      window.setAgentActive(true);const start=Date.now();
      await window.stepDebugger.intercept("getCart",params,this.inputSchema);
      let result;
      try{
        const itemCount=cart.reduce((s,i)=>s+i.quantity,0),orderTotal=cart.reduce((s,i)=>s+i.lineTotal,0).toFixed(2);
        result={cart:cart.slice(),itemCount,orderTotal,readonly:true,note:"Use addToCart to modify cart"};
      }catch(err){const r={error:err.message};window.stepDebugger.showResponse("getCart",r,true);window.logToolCall("getCart",params,r,true,Date.now()-start);window.setAgentActive(false);throw err;}
      window.stepDebugger.showResponse("getCart",result,false);window.logToolCall("getCart",params,result,false,Date.now()-start);window.setAgentActive(false);
      return{content:[{type:"text",text:JSON.stringify(result)}]};
    }
  });

  window.logToolCall("SYSTEM",{},{message:"5 tools registered: searchProducts, configureProduct, getQuote, addToCart, getCart"},false,0);
};

// === REAL CUSTOMINK LOGO ===
const CI_LOGO_SRC = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIIAAAAwCAIAAABSYzXUAAAF9ElEQVR4nOxc65HbRgxeSkw/dgEZX0px/ict+NxCCrBLiTMpwOnHphhQHwWDWCwWS1Fn2eI3Nze6JfaJ5wLU9eM4pkaMnz/R7+Hje/kn0L1+ot8H/H77Lu2IoWtiw+nj+9PnT/LcK6O/fiKW7PyoIsQGOneS/fjp5zj+/rwzw0GdDaQBw4fntAV2ZpTQO8+uVwIFsHPnRI6iNgSVANZftkR69X/93S17PThsbYjwgM7x+PZd6TT97l///G03UBKGNkR4UBXnTQZ5HGg2RI4vKMi34wTc1fjfPynzNPQo3s6NTruCIuNlJMvnlRaTT63Z8OXXLrloMiZkfHwPTzwgTqQwaDQa0xmEZ5TrlL1++XdMhegDXcwpGOieCkKmDocPM9+menSQz06Xi7GDJoN+rBHTniOTAkRpHhANQrtqiujMCJCONbgYWoap6KUR1DZzml4+i7jl1IIIPU3avXpTpVTLQ4Qmr/R0NCyqPkbRiySRjAPGYW2gD7w2fOAWrIS7c6DIlKWgnLdpnnMv6VINh3Y7ThNX5ZRks6+NLJfHHoV2i10hbEsxsFGmXvjB6WNMtKRlroyPVR6iNEG8EizVtBm0zWPhnA88egqA+JkaEeHc2JKnos1L1aENkxI0uXreBawZpLtV0XMfeRDhu7kdx+vMbNgqXbEagysHpmCuBsv7PPWHZzqdKWsZkMVTTFxUoCVtmtkysSHuJNXoERGOrjumEFvdM0h71EEQM+inIXlsGQZWfbVrIpbT5Vw5gAgCQo+VyivI0RG3SC2Djiu9K21MzagktIQNE1ywZlgANw5hiTQp+XxyU8wmy4z4Jxc9ha5La5su9wtVXTgI2wfHKMNhrEytQLroeR3n8btsRgeSmNiv7lA0b15oopV/uzdYdzH4A6aBWa6ymRb/Fbe2jHIRQVm6Qn2HwmaLGVYOIVIZ8Dlc2KEPw5k9dATMnqbbmQMSIo5D5hWetwrlG877n3RfHBMYBonhQfABt7xJEZfnVdVIHAuOm1SfY1zitJzFHEeJu8Q3NkCsUqyECT2guWXIz12qARWrWnA6ELBqmgFFvnmY+5ySxTZ/GonrmNOlKVbEkxMb1M1+uCzRz1uY1jwSxqgMx8D2tNaXGF+6Y8qlEpkZFzINRCe3Kl2sXguXVoot12XJppySn0fymaEibj8A9y/qwfwS4jpoBt/a8km5bM4OSdGoccyaObPTXJiszJtpfxCY3aXtmbx3SXMVTGbwfYSvneZRjuEq3sOmvrsvfzxFDgjIkzbyZljigZOw1KtpTLj+NOibsgh5Ix2cn1DzLekO4BA0AtfULKmjyUKD8lGLcX2I6GqTDRZerxPs9OAP+c+0dMKKTPlD0LCpdCrqL4ZeRsE5Orfu34QIJ6oKx93HLB1NF9RepHTmCuWS7HSZYnHjvQNvdIDtNp9Re64H8XpZnrPkNE5OfL1zjmfLVc0g3QEmozTFra/eyOt4rgSs19hqVWw5hTDldkgkrcs2CNC+SYAUKR+p3Mb1afNNMPsGM4PEb25XpYzkq1TInLbN5vssejTLnIPa+gg4j+TQcGY0eGd+Gdgu2r9w5WZqzraKdpMlnJtDTu0WjhEl39JTuaPj3fAgcfVNAoUERwP025IXY6U8gXPKXPBKG0EmuII1g2G72a+HZkPr+9sy5GiqXq2g93EUbyVFhh1bCuC3RsaGwMrM1xQAqUYRrR82VYhI2CPz4fejEJoN9fLTZasy5JCQPjC9LCJVvOlK36g3L4AFG5rWVErYqWRfcrH5KUQC3xWO5NZYsCEiv3wLdWjYXR8D4pk2RRd7teDeFEIbJX8PsEgRNw73Wz2UW+TyjrEK2l0phL43+CmmFfcdZ8AVFyjIAd85zOq39NVo5xZJhpKqavxeML5mMhZeXuf0RjCo5XyUSf+wFR4T3nffzBxyCnxrYe61zNg4A+7oVvyXgHVs2OGgW/fPGiLl5eC3DXYkM6dURSQovJM8/o+CNWxINeN+VznkHwJrjBLDdBK7S1iBq9iQxBdLKQoqvUC3o4r/AQAA///3F/dAAAAABklEQVQDALtk/hyt8VF1AAAAAElFTkSuQmCC";

// === INIT ===
document.addEventListener("DOMContentLoaded",()=>{
  // Apply real CustomInk logo to all logo img elements
  document.querySelectorAll(".ci-logo-img").forEach(img => { img.src = CI_LOGO_SRC; });

  window.renderProducts(PRODUCTS);
  window.renderCart(cart);
  window.stepDebugger.init();
});
</script>

<script type="module">
// Polyfill loader
(async function() {
  if (!("modelContext" in window.navigator)) {
    document.getElementById("polyfill-warning").hidden = false;
    window.logToolCall("SYSTEM",{},{message:"âš  navigator.modelContext not found. Loading @mcp-b/global polyfillâ€¦"},false,0);
    await new Promise((res,rej)=>{
      const s=document.createElement("script");
      s.type="module";
      s.src="https://unpkg.com/@mcp-b/global@latest/dist/index.js";
      s.onload=res;
      s.onerror=()=>rej(new Error("Failed to load @mcp-b/global from CDN"));
      document.head.appendChild(s);
    });
    window.logToolCall("SYSTEM",{},{message:"âœ“ @mcp-b/global polyfill loaded."},false,0);
    document.getElementById("webmcp-badge").textContent="WebMCP âš  Polyfill";
    document.getElementById("webmcp-badge").style.background="rgba(168,104,0,0.08)";
    document.getElementById("webmcp-badge").style.borderColor="rgba(168,104,0,0.3)";
    document.getElementById("webmcp-badge").style.color="#a86800";
  } else {
    window.logToolCall("SYSTEM",{},{message:"âœ“ navigator.modelContext detected â€” native WebMCP active."},false,0);
    document.getElementById("webmcp-badge").textContent="WebMCP âœ“ Native";
    document.getElementById("webmcp-badge").style.background="rgba(25,128,56,0.08)";
    document.getElementById("webmcp-badge").style.borderColor="rgba(25,128,56,0.3)";
    document.getElementById("webmcp-badge").style.color="#198038";
  }
  window.registerAllTools();
})().catch(err=>{
  window.logToolCall("SYSTEM",{},{message:`âœ— WebMCP init failed: ${err.message}`},true,0);
});
</script>

</body>
</html>
